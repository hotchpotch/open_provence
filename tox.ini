[tox]
requires = tox-uv>=1.11.1
envlist = pytests, lint, format-check, typecheck
isolated_build = false
skip_missing_interpreters = true

[testenv]
runner = uv-venv-lock-runner
dependency_groups = 
    dev
    cpu
no_default_groups = true
skip_install = true
commands = python -c "raise SystemExit('Specify a concrete environment, e.g. `tox -e lint`')"  # guard

[testenv:pytests]
commands =
    pytest --maxfail=1 --durations=5 -n auto --maxprocesses=4 --dist loadscope

[testenv:lint]
commands =
    ruff check open_provence tests scripts

[testenv:format-check]
commands =
    ruff format --check --diff open_provence tests scripts

[testenv:typecheck]
commands =
    pyright --threads 4 open_provence tests scripts
